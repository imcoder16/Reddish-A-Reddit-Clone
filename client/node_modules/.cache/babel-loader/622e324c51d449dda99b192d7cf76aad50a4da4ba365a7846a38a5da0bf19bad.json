{"ast":null,"code":"import _regeneratorRuntime from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import userService from'../services/user';import postService from'../services/posts';var userPageReducer=function userPageReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'FETCH_USER':return action.payload;case'TOGGLE_USERPAGE_VOTE':return _objectSpread(_objectSpread({},state),{},{posts:_objectSpread(_objectSpread({},state.posts),{},{results:state.posts.results.map(function(r){return r.id!==action.payload.id?r:_objectSpread(_objectSpread({},r),action.payload.data);})})});case'LOAD_USER_POSTS':return _objectSpread(_objectSpread({},state),{},{posts:_objectSpread(_objectSpread({},action.payload.posts),{},{results:[].concat(_toConsumableArray(state.posts.results),_toConsumableArray(action.payload.posts.results))})});default:return state;}};export var fetchUser=function fetchUser(username){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return userService.getUser(username,5,1);case 2:user=_context.sent;dispatch({type:'FETCH_USER',payload:user});case 4:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loadUserPosts=function loadUserPosts(username,page){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var user;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return userService.getUser(username,5,page);case 2:user=_context2.sent;dispatch({type:'LOAD_USER_POSTS',payload:user});case 4:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var toggleUpvote=function toggleUpvote(id,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var pointsCount;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_USERPAGE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context3.next=5;return postService.upvotePost(id);case 5:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var toggleDownvote=function toggleDownvote(id,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var pointsCount;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_USERPAGE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context4.next=5;return postService.downvotePost(id);case 5:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export default userPageReducer;","map":{"version":3,"names":["userService","postService","userPageReducer","state","arguments","length","undefined","action","type","payload","_objectSpread","posts","results","map","r","id","data","concat","_toConsumableArray","fetchUser","username","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","user","wrap","_callee$","_context","prev","next","getUser","sent","stop","_x","apply","loadUserPosts","page","_ref2","_callee2","_callee2$","_context2","_x2","toggleUpvote","upvotedBy","downvotedBy","_ref3","_callee3","pointsCount","_callee3$","_context3","upvotePost","_x3","toggleDownvote","_ref4","_callee4","_callee4$","_context4","downvotePost","_x4"],"sources":["C:/Ak/E/reddish-master/client/src/reducers/userPageReducer.js"],"sourcesContent":["import userService from '../services/user';\nimport postService from '../services/posts';\n\nconst userPageReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'FETCH_USER':\n      return action.payload;\n    case 'TOGGLE_USERPAGE_VOTE':\n      return {\n        ...state,\n        posts: {\n          ...state.posts,\n          results: state.posts.results.map((r) =>\n            r.id !== action.payload.id ? r : { ...r, ...action.payload.data }\n          ),\n        },\n      };\n    case 'LOAD_USER_POSTS':\n      return {\n        ...state,\n        posts: {\n          ...action.payload.posts,\n          results: [...state.posts.results, ...action.payload.posts.results],\n        },\n      };\n    default:\n      return state;\n  }\n};\n\nexport const fetchUser = (username) => {\n  return async (dispatch) => {\n    const user = await userService.getUser(username, 5, 1);\n\n    dispatch({\n      type: 'FETCH_USER',\n      payload: user,\n    });\n  };\n};\n\nexport const loadUserPosts = (username, page) => {\n  return async (dispatch) => {\n    const user = await userService.getUser(username, 5, page);\n\n    dispatch({\n      type: 'LOAD_USER_POSTS',\n      payload: user,\n    });\n  };\n};\n\nexport const toggleUpvote = (id, upvotedBy, downvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_USERPAGE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.upvotePost(id);\n  };\n};\n\nexport const toggleDownvote = (id, downvotedBy, upvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_USERPAGE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.downvotePost(id);\n  };\n};\n\nexport default userPageReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}