{"ast":null,"code":"import _regeneratorRuntime from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import authService from'../services/auth';import userService from'../services/user';import storageService from'../utils/localStorage';var userReducer=function userReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'LOGIN':return action.payload;case'SIGNUP':return action.payload;case'LOGOUT':return null;case'SET_USER':return action.payload;case'SET_AVATAR':return _objectSpread(_objectSpread({},state),action.payload);case'REMOVE_AVATAR':return _objectSpread(_objectSpread({},state),{},{avatar:{exists:false}});default:return state;}};export var loginUser=function loginUser(credentials){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var user;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return authService.login(credentials);case 2:user=_context.sent;storageService.saveUser(user);authService.setToken(user.token);dispatch({type:'LOGIN',payload:user});case 6:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var signupUser=function signupUser(credentials){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var user;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authService.signup(credentials);case 2:user=_context2.sent;storageService.saveUser(user);authService.setToken(user.token);dispatch({type:'SIGNUP',payload:user});case 6:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logoutUser=function logoutUser(){return function(dispatch){storageService.logoutUser();authService.setToken(null);dispatch({type:'LOGOUT'});};};export var setUser=function setUser(){return function(dispatch){var loggedUser=storageService.loadUser();if(loggedUser){authService.setToken(loggedUser.token);dispatch({type:'SET_USER',payload:loggedUser});}};};export var setAvatar=function setAvatar(avatarImage){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var uploadedAvatar,prevUserData;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:_context3.next=2;return userService.uploadAvatar({avatarImage:avatarImage});case 2:uploadedAvatar=_context3.sent;prevUserData=storageService.loadUser();storageService.saveUser(_objectSpread(_objectSpread({},prevUserData),uploadedAvatar));dispatch({type:'SET_AVATAR',payload:uploadedAvatar});case 6:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var deleteAvatar=function deleteAvatar(){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var prevUserData;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:_context4.next=2;return userService.removeAvatar();case 2:prevUserData=storageService.loadUser();storageService.saveUser(_objectSpread(_objectSpread({},prevUserData),{},{avatar:{exists:false}}));dispatch({type:'REMOVE_AVATAR'});case 5:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export default userReducer;","map":{"version":3,"names":["authService","userService","storageService","userReducer","state","arguments","length","undefined","action","type","payload","_objectSpread","avatar","exists","loginUser","credentials","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","user","wrap","_callee$","_context","prev","next","login","sent","saveUser","setToken","token","stop","_x","apply","signupUser","_ref2","_callee2","_callee2$","_context2","signup","_x2","logoutUser","setUser","loggedUser","loadUser","setAvatar","avatarImage","_ref3","_callee3","uploadedAvatar","prevUserData","_callee3$","_context3","uploadAvatar","_x3","deleteAvatar","_ref4","_callee4","_callee4$","_context4","removeAvatar","_x4"],"sources":["C:/Ak/E/reddish-master/client/src/reducers/userReducer.js"],"sourcesContent":["import authService from '../services/auth';\nimport userService from '../services/user';\nimport storageService from '../utils/localStorage';\n\nconst userReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'LOGIN':\n      return action.payload;\n    case 'SIGNUP':\n      return action.payload;\n    case 'LOGOUT':\n      return null;\n    case 'SET_USER':\n      return action.payload;\n    case 'SET_AVATAR':\n      return { ...state, ...action.payload };\n    case 'REMOVE_AVATAR':\n      return { ...state, avatar: { exists: false } };\n    default:\n      return state;\n  }\n};\n\nexport const loginUser = (credentials) => {\n  return async (dispatch) => {\n    const user = await authService.login(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n\n    dispatch({\n      type: 'LOGIN',\n      payload: user,\n    });\n  };\n};\n\nexport const signupUser = (credentials) => {\n  return async (dispatch) => {\n    const user = await authService.signup(credentials);\n    storageService.saveUser(user);\n    authService.setToken(user.token);\n\n    dispatch({\n      type: 'SIGNUP',\n      payload: user,\n    });\n  };\n};\n\nexport const logoutUser = () => {\n  return (dispatch) => {\n    storageService.logoutUser();\n    authService.setToken(null);\n\n    dispatch({\n      type: 'LOGOUT',\n    });\n  };\n};\n\nexport const setUser = () => {\n  return (dispatch) => {\n    const loggedUser = storageService.loadUser();\n\n    if (loggedUser) {\n      authService.setToken(loggedUser.token);\n\n      dispatch({\n        type: 'SET_USER',\n        payload: loggedUser,\n      });\n    }\n  };\n};\n\nexport const setAvatar = (avatarImage) => {\n  return async (dispatch) => {\n    const uploadedAvatar = await userService.uploadAvatar({ avatarImage });\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({ ...prevUserData, ...uploadedAvatar });\n\n    dispatch({\n      type: 'SET_AVATAR',\n      payload: uploadedAvatar,\n    });\n  };\n};\n\nexport const deleteAvatar = () => {\n  return async (dispatch) => {\n    await userService.removeAvatar();\n    const prevUserData = storageService.loadUser();\n    storageService.saveUser({ ...prevUserData, avatar: { exists: false } });\n\n    dispatch({\n      type: 'REMOVE_AVATAR',\n    });\n  };\n};\n\nexport default userReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}