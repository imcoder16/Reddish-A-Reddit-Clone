{"ast":null,"code":"import _regeneratorRuntime from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useSelector,useDispatch}from'react-redux';import{fetchPosts,loadMorePosts,toggleUpvote,toggleDownvote}from'../reducers/postReducer';import{notify}from'../reducers/notificationReducer';import PostCard from'./PostCard';import SortTabBar from'./SortTabBar';import LoadMoreButton from'./LoadMoreButton';import LoadingSpinner from'./LoadingSpinner';import getErrorMsg from'../utils/getErrorMsg';import{Typography}from'@material-ui/core';import{usePostListStyles}from'../styles/muiStyles';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var PostList=function PostList(){var _useState=useState('hot'),_useState2=_slicedToArray(_useState,2),sortBy=_useState2[0],setSortBy=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),page=_useState4[0],setPage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loadingMore=_useState6[0],setLoadingMore=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),pageLoading=_useState8[0],setPageLoading=_useState8[1];var posts=useSelector(function(state){return state.posts;});var user=useSelector(function(state){return state.user;});var dispatch=useDispatch();var classes=usePostListStyles();var handleTabChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e,newValue){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setPageLoading(true);_context.next=4;return dispatch(fetchPosts(newValue));case 4:setSortBy(newValue);setPageLoading(false);if(page!==1){setPage(1);}_context.next=13;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);setPageLoading(false);dispatch(notify(getErrorMsg(_context.t0),'error'));case 13:case\"end\":return _context.stop();}},_callee,null,[[0,9]]);}));return function handleTabChange(_x,_x2){return _ref.apply(this,arguments);};}();var handleLoadPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoadingMore(true);_context2.next=4;return dispatch(loadMorePosts(sortBy,page+1));case 4:setPage(function(prevState){return prevState+1;});setLoadingMore(false);_context2.next=12;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);setLoadingMore(false);dispatch(notify(getErrorMsg(_context2.t0),'error'));case 12:case\"end\":return _context2.stop();}},_callee2,null,[[0,8]]);}));return function handleLoadPosts(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:classes.root,children:[/*#__PURE__*/_jsx(SortTabBar,{sortBy:sortBy,handleTabChange:handleTabChange,subscribedTab:true,user:user}),posts&&posts.results&&!pageLoading?posts.results.map(function(post){return/*#__PURE__*/_jsx(PostCard,{post:post,toggleUpvote:toggleUpvote,toggleDownvote:toggleDownvote},post.id);}):/*#__PURE__*/_jsx(LoadingSpinner,{text:'Fetching posts. Wait a sec.'}),sortBy==='subscribed'&&posts.results.length===0&&/*#__PURE__*/_jsxs(\"div\",{className:classes.noSubscribedPosts,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",color:\"secondary\",children:\"No Posts Found\"}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",color:\"secondary\",children:\"Subscribe to more subs if you haven't!\"})]}),posts&&'next'in posts&&!pageLoading&&/*#__PURE__*/_jsx(LoadMoreButton,{handleLoadPosts:handleLoadPosts,loading:loadingMore})]});};export default PostList;","map":{"version":3,"names":["React","useState","useSelector","useDispatch","fetchPosts","loadMorePosts","toggleUpvote","toggleDownvote","notify","PostCard","SortTabBar","LoadMoreButton","LoadingSpinner","getErrorMsg","Typography","usePostListStyles","jsx","_jsx","jsxs","_jsxs","PostList","_useState","_useState2","_slicedToArray","sortBy","setSortBy","_useState3","_useState4","page","setPage","_useState5","_useState6","loadingMore","setLoadingMore","_useState7","_useState8","pageLoading","setPageLoading","posts","state","user","dispatch","classes","handleTabChange","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","newValue","wrap","_callee$","_context","prev","next","t0","stop","_x","_x2","apply","arguments","handleLoadPosts","_ref2","_callee2","_callee2$","_context2","prevState","className","root","children","subscribedTab","results","map","post","id","text","length","noSubscribedPosts","variant","color","loading"],"sources":["C:/Ak/E/reddish-master/client/src/components/PostList.js"],"sourcesContent":["import React, { useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport {\n  fetchPosts,\n  loadMorePosts,\n  toggleUpvote,\n  toggleDownvote,\n} from '../reducers/postReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport PostCard from './PostCard';\nimport SortTabBar from './SortTabBar';\nimport LoadMoreButton from './LoadMoreButton';\nimport LoadingSpinner from './LoadingSpinner';\nimport getErrorMsg from '../utils/getErrorMsg';\n\nimport { Typography } from '@material-ui/core';\nimport { usePostListStyles } from '../styles/muiStyles';\n\nconst PostList = () => {\n  const [sortBy, setSortBy] = useState('hot');\n  const [page, setPage] = useState(1);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [pageLoading, setPageLoading] = useState(false);\n  const posts = useSelector((state) => state.posts);\n  const user = useSelector((state) => state.user);\n  const dispatch = useDispatch();\n  const classes = usePostListStyles();\n\n  const handleTabChange = async (e, newValue) => {\n    try {\n      setPageLoading(true);\n      await dispatch(fetchPosts(newValue));\n      setSortBy(newValue);\n      setPageLoading(false);\n\n      if (page !== 1) {\n        setPage(1);\n      }\n    } catch (err) {\n      setPageLoading(false);\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  const handleLoadPosts = async () => {\n    try {\n      setLoadingMore(true);\n      await dispatch(loadMorePosts(sortBy, page + 1));\n      setPage((prevState) => prevState + 1);\n      setLoadingMore(false);\n    } catch (err) {\n      setLoadingMore(false);\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  return (\n    <div className={classes.root}>\n      <SortTabBar\n        sortBy={sortBy}\n        handleTabChange={handleTabChange}\n        subscribedTab={true}\n        user={user}\n      />\n      {posts && posts.results && !pageLoading ? (\n        posts.results.map((post) => (\n          <PostCard\n            post={post}\n            key={post.id}\n            toggleUpvote={toggleUpvote}\n            toggleDownvote={toggleDownvote}\n          />\n        ))\n      ) : (\n        <LoadingSpinner text={'Fetching posts. Wait a sec.'} />\n      )}\n      {sortBy === 'subscribed' && posts.results.length === 0 && (\n        <div className={classes.noSubscribedPosts}>\n          <Typography variant=\"h5\" color=\"secondary\">\n            No Posts Found\n          </Typography>\n          <Typography variant=\"h6\" color=\"secondary\">\n            Subscribe to more subs if you haven't!\n          </Typography>\n        </div>\n      )}\n      {posts && 'next' in posts && !pageLoading && (\n        <LoadMoreButton\n          handleLoadPosts={handleLoadPosts}\n          loading={loadingMore}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default PostList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}