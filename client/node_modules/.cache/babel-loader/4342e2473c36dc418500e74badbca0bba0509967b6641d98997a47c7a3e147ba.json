{"ast":null,"code":"import _regeneratorRuntime from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import subService from'../services/subs';import postService from'../services/posts';var subPageReducer=function subPageReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'FETCH_SUB':return action.payload;case'LOAD_SUB_POSTS':return _objectSpread(_objectSpread({},state),{},{posts:_objectSpread(_objectSpread({},action.payload.posts),{},{results:[].concat(_toConsumableArray(state.posts.results),_toConsumableArray(action.payload.posts.results))})});case'TOGGLE_SUBPAGE_VOTE':return _objectSpread(_objectSpread({},state),{},{posts:_objectSpread(_objectSpread({},state.posts),{},{results:state.posts.results.map(function(p){return p.id!==action.payload.id?p:_objectSpread(_objectSpread({},p),action.payload.data);})})});case'SUBSCRIBE_SUB':return _objectSpread(_objectSpread({},state),{},{subDetails:_objectSpread(_objectSpread({},state.subDetails),action.payload)});case'EDIT_DESCRIPTION':return _objectSpread(_objectSpread({},state),{},{subDetails:_objectSpread(_objectSpread({},state.subDetails),{},{description:action.payload})});default:return state;}};export var fetchSub=function fetchSub(subredditName,sortBy){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var sub;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return subService.getSubreddit(subredditName,sortBy,10,1);case 2:sub=_context.sent;dispatch({type:'FETCH_SUB',payload:sub});case 4:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loadSubPosts=function loadSubPosts(subredditName,sortBy,page){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var sub;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.next=2;return subService.getSubreddit(subredditName,sortBy,10,page);case 2:sub=_context2.sent;dispatch({type:'LOAD_SUB_POSTS',payload:sub});case 4:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var toggleUpvote=function toggleUpvote(id,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var pointsCount;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_SUBPAGE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context3.next=5;return postService.upvotePost(id);case 5:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var toggleDownvote=function toggleDownvote(id,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var pointsCount;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_SUBPAGE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context4.next=5;return postService.downvotePost(id);case 5:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var toggleSubscribe=function toggleSubscribe(id,subscribedBy){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch){var subscriberCount;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:subscriberCount=subscribedBy.length;dispatch({type:'SUBSCRIBE_SUB',payload:{subscribedBy:subscribedBy,subscriberCount:subscriberCount}});_context5.next=4;return subService.subscribeSub(id);case 4:case\"end\":return _context5.stop();}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();};export var editDescription=function editDescription(id,description){return/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(dispatch){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1)switch(_context6.prev=_context6.next){case 0:_context6.next=2;return subService.updateDescription(id,{description:description});case 2:dispatch({type:'EDIT_DESCRIPTION',payload:description});case 3:case\"end\":return _context6.stop();}},_callee6);}));return function(_x6){return _ref6.apply(this,arguments);};}();};export default subPageReducer;","map":{"version":3,"names":["subService","postService","subPageReducer","state","arguments","length","undefined","action","type","payload","_objectSpread","posts","results","concat","_toConsumableArray","map","p","id","data","subDetails","description","fetchSub","subredditName","sortBy","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","sub","wrap","_callee$","_context","prev","next","getSubreddit","sent","stop","_x","apply","loadSubPosts","page","_ref2","_callee2","_callee2$","_context2","_x2","toggleUpvote","upvotedBy","downvotedBy","_ref3","_callee3","pointsCount","_callee3$","_context3","upvotePost","_x3","toggleDownvote","_ref4","_callee4","_callee4$","_context4","downvotePost","_x4","toggleSubscribe","subscribedBy","_ref5","_callee5","subscriberCount","_callee5$","_context5","subscribeSub","_x5","editDescription","_ref6","_callee6","_callee6$","_context6","updateDescription","_x6"],"sources":["C:/Ak/E/reddish-master/client/src/reducers/subPageReducer.js"],"sourcesContent":["import subService from '../services/subs';\nimport postService from '../services/posts';\n\nconst subPageReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'FETCH_SUB':\n      return action.payload;\n    case 'LOAD_SUB_POSTS':\n      return {\n        ...state,\n        posts: {\n          ...action.payload.posts,\n          results: [...state.posts.results, ...action.payload.posts.results],\n        },\n      };\n    case 'TOGGLE_SUBPAGE_VOTE':\n      return {\n        ...state,\n        posts: {\n          ...state.posts,\n          results: state.posts.results.map((p) =>\n            p.id !== action.payload.id ? p : { ...p, ...action.payload.data }\n          ),\n        },\n      };\n    case 'SUBSCRIBE_SUB':\n      return {\n        ...state,\n        subDetails: { ...state.subDetails, ...action.payload },\n      };\n    case 'EDIT_DESCRIPTION':\n      return {\n        ...state,\n        subDetails: { ...state.subDetails, description: action.payload },\n      };\n    default:\n      return state;\n  }\n};\n\nexport const fetchSub = (subredditName, sortBy) => {\n  return async (dispatch) => {\n    const sub = await subService.getSubreddit(subredditName, sortBy, 10, 1);\n\n    dispatch({\n      type: 'FETCH_SUB',\n      payload: sub,\n    });\n  };\n};\n\nexport const loadSubPosts = (subredditName, sortBy, page) => {\n  return async (dispatch) => {\n    const sub = await subService.getSubreddit(subredditName, sortBy, 10, page);\n\n    dispatch({\n      type: 'LOAD_SUB_POSTS',\n      payload: sub,\n    });\n  };\n};\n\nexport const toggleUpvote = (id, upvotedBy, downvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_SUBPAGE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.upvotePost(id);\n  };\n};\n\nexport const toggleDownvote = (id, downvotedBy, upvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_SUBPAGE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.downvotePost(id);\n  };\n};\n\nexport const toggleSubscribe = (id, subscribedBy) => {\n  return async (dispatch) => {\n    const subscriberCount = subscribedBy.length;\n\n    dispatch({\n      type: 'SUBSCRIBE_SUB',\n      payload: { subscribedBy, subscriberCount },\n    });\n\n    await subService.subscribeSub(id);\n  };\n};\n\nexport const editDescription = (id, description) => {\n  return async (dispatch) => {\n    await subService.updateDescription(id, { description });\n\n    dispatch({\n      type: 'EDIT_DESCRIPTION',\n      payload: description,\n    });\n  };\n};\n\nexport default subPageReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}