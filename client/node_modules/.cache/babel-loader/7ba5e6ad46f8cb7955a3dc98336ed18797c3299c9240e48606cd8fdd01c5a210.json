{"ast":null,"code":"import _regeneratorRuntime from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import postService from'../services/posts';var postReducer=function postReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case'SET_POSTS':return action.payload;case'LOAD_MORE_POSTS':return _objectSpread(_objectSpread({},action.payload),{},{results:[].concat(_toConsumableArray(state.results),_toConsumableArray(action.payload.results))});case'TOGGLE_VOTE':return _objectSpread(_objectSpread({},state),{},{results:state.results.map(function(r){return r.id!==action.payload.id?r:_objectSpread(_objectSpread({},r),action.payload.data);})});case'DELETE_POST':return _objectSpread(_objectSpread({},state),{},{results:state.results.filter(function(r){return r.id!==action.payload;})});default:return state;}};export var fetchPosts=function fetchPosts(sortBy){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var posts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!(sortBy!=='subscribed')){_context.next=6;break;}_context.next=3;return postService.getPosts(sortBy,10,1);case 3:posts=_context.sent;_context.next=9;break;case 6:_context.next=8;return postService.getSubPosts(10,1);case 8:posts=_context.sent;case 9:dispatch({type:'SET_POSTS',payload:posts});case 10:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var loadMorePosts=function loadMorePosts(sortBy,page){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dispatch){var posts;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:if(!(sortBy!=='subscribed')){_context2.next=6;break;}_context2.next=3;return postService.getPosts(sortBy,10,page);case 3:posts=_context2.sent;_context2.next=9;break;case 6:_context2.next=8;return postService.getSubPosts(10,page);case 8:posts=_context2.sent;case 9:dispatch({type:'LOAD_MORE_POSTS',payload:posts});case 10:case\"end\":return _context2.stop();}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var toggleUpvote=function toggleUpvote(id,upvotedBy,downvotedBy){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var pointsCount;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1)switch(_context3.prev=_context3.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context3.next=5;return postService.upvotePost(id);case 5:case\"end\":return _context3.stop();}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export var toggleDownvote=function toggleDownvote(id,downvotedBy,upvotedBy){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){var pointsCount;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1)switch(_context4.prev=_context4.next){case 0:pointsCount=upvotedBy.length-downvotedBy.length;if(pointsCount<0){pointsCount=0;}dispatch({type:'TOGGLE_VOTE',payload:{id:id,data:{upvotedBy:upvotedBy,pointsCount:pointsCount,downvotedBy:downvotedBy}}});_context4.next=5;return postService.downvotePost(id);case 5:case\"end\":return _context4.stop();}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};export var removePost=function removePost(id){return/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(dispatch){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1)switch(_context5.prev=_context5.next){case 0:_context5.next=2;return postService.deletePost(id);case 2:dispatch({type:'DELETE_POST',payload:id});case 3:case\"end\":return _context5.stop();}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();};export default postReducer;","map":{"version":3,"names":["postService","postReducer","state","arguments","length","undefined","action","type","payload","_objectSpread","results","concat","_toConsumableArray","map","r","id","data","filter","fetchPosts","sortBy","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","dispatch","posts","wrap","_callee$","_context","prev","next","getPosts","sent","getSubPosts","stop","_x","apply","loadMorePosts","page","_ref2","_callee2","_callee2$","_context2","_x2","toggleUpvote","upvotedBy","downvotedBy","_ref3","_callee3","pointsCount","_callee3$","_context3","upvotePost","_x3","toggleDownvote","_ref4","_callee4","_callee4$","_context4","downvotePost","_x4","removePost","_ref5","_callee5","_callee5$","_context5","deletePost","_x5"],"sources":["C:/Ak/E/reddish-master/client/src/reducers/postReducer.js"],"sourcesContent":["import postService from '../services/posts';\n\nconst postReducer = (state = null, action) => {\n  switch (action.type) {\n    case 'SET_POSTS':\n      return action.payload;\n    case 'LOAD_MORE_POSTS':\n      return {\n        ...action.payload,\n        results: [...state.results, ...action.payload.results],\n      };\n    case 'TOGGLE_VOTE':\n      return {\n        ...state,\n        results: state.results.map((r) =>\n          r.id !== action.payload.id ? r : { ...r, ...action.payload.data }\n        ),\n      };\n    case 'DELETE_POST':\n      return {\n        ...state,\n        results: state.results.filter((r) => r.id !== action.payload),\n      };\n    default:\n      return state;\n  }\n};\n\nexport const fetchPosts = (sortBy) => {\n  return async (dispatch) => {\n    let posts;\n\n    if (sortBy !== 'subscribed') {\n      posts = await postService.getPosts(sortBy, 10, 1);\n    } else {\n      posts = await postService.getSubPosts(10, 1);\n    }\n\n    dispatch({\n      type: 'SET_POSTS',\n      payload: posts,\n    });\n  };\n};\n\nexport const loadMorePosts = (sortBy, page) => {\n  return async (dispatch) => {\n    let posts;\n    if (sortBy !== 'subscribed') {\n      posts = await postService.getPosts(sortBy, 10, page);\n    } else {\n      posts = await postService.getSubPosts(10, page);\n    }\n\n    dispatch({\n      type: 'LOAD_MORE_POSTS',\n      payload: posts,\n    });\n  };\n};\n\nexport const toggleUpvote = (id, upvotedBy, downvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.upvotePost(id);\n  };\n};\n\nexport const toggleDownvote = (id, downvotedBy, upvotedBy) => {\n  return async (dispatch) => {\n    let pointsCount = upvotedBy.length - downvotedBy.length;\n    if (pointsCount < 0) {\n      pointsCount = 0;\n    }\n\n    dispatch({\n      type: 'TOGGLE_VOTE',\n      payload: { id, data: { upvotedBy, pointsCount, downvotedBy } },\n    });\n\n    await postService.downvotePost(id);\n  };\n};\n\nexport const removePost = (id) => {\n  return async (dispatch) => {\n    await postService.deletePost(id);\n\n    dispatch({\n      type: 'DELETE_POST',\n      payload: id,\n    });\n  };\n};\n\nexport default postReducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}