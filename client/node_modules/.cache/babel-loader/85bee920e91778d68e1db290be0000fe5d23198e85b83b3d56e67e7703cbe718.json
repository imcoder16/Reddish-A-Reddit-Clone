{"ast":null,"code":"import _regeneratorRuntime from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Ak/E/reddish-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{useParams}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{setSearchResults,toggleUpvote,toggleDownvote,loadSearchPosts}from'../reducers/searchReducer';import{notify}from'../reducers/notificationReducer';import PostCard from'./PostCard';import LoadMoreButton from'./LoadMoreButton';import LoadingSpinner from'./LoadingSpinner';import getErrorMsg from'../utils/getErrorMsg';import{Container,Paper,Typography}from'@material-ui/core';import{useSearchPageStyles}from'../styles/muiStyles';import SearchIcon from'@material-ui/icons/Search';import SentimentVeryDissatisfiedIcon from'@material-ui/icons/SentimentVeryDissatisfied';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SearchResults=function SearchResults(){var classes=useSearchPageStyles();var _useParams=useParams(),query=_useParams.query;var dispatch=useDispatch();var searchResults=useSelector(function(state){return state.search;});var _useState=useState(1),_useState2=_slicedToArray(_useState,2),page=_useState2[0],setPage=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingMore=_useState4[0],setLoadingMore=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),pageLoading=_useState6[0],setPageLoading=_useState6[1];useEffect(function(){var getSearchResults=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;setPageLoading(true);_context.next=4;return dispatch(setSearchResults(query));case 4:setPageLoading(false);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);dispatch(notify(getErrorMsg(_context.t0),'error'));case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function getSearchResults(){return _ref.apply(this,arguments);};}();getSearchResults();setPage(1);// eslint-disable-next-line react-hooks/exhaustive-deps\n},[query]);if(!searchResults||pageLoading){return/*#__PURE__*/_jsx(Container,{disableGutters:true,children:/*#__PURE__*/_jsx(Paper,{variant:\"outlined\",className:classes.mainPaper,children:/*#__PURE__*/_jsx(LoadingSpinner,{text:'Searching for matches...'})})});}var handleLoadPosts=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;setLoadingMore(true);_context2.next=4;return dispatch(loadSearchPosts(query,page+1));case 4:setPage(function(prevState){return prevState+1;});setLoadingMore(false);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);dispatch(notify(getErrorMsg(_context2.t0),'error'));case 11:case\"end\":return _context2.stop();}},_callee2,null,[[0,8]]);}));return function handleLoadPosts(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Container,{disableGutters:true,children:/*#__PURE__*/_jsxs(Paper,{variant:\"outlined\",className:classes.mainPaper,children:[/*#__PURE__*/_jsx(Paper,{variant:\"outlined\",children:/*#__PURE__*/_jsxs(Typography,{variant:\"h6\",color:\"secondary\",className:classes.infoPaper,children:[/*#__PURE__*/_jsx(SearchIcon,{fontSize:\"large\",style:{marginRight:'7px'}}),\"Showing search results for \\\"\",query,\"\\\"\"]})}),searchResults.results.length!==0?searchResults.results.map(function(s){return/*#__PURE__*/_jsx(PostCard,{post:s,toggleUpvote:toggleUpvote,toggleDownvote:toggleDownvote},s.id);}):/*#__PURE__*/_jsxs(Typography,{variant:\"h5\",className:classes.noResults,children:[/*#__PURE__*/_jsx(SentimentVeryDissatisfiedIcon,{className:classes.sorryIcon,color:\"primary\"}),\"Sorry, there were no post results for \\\"\",query,\"\\\"\"]}),'next'in searchResults&&/*#__PURE__*/_jsx(LoadMoreButton,{handleLoadPosts:handleLoadPosts,loading:loadingMore})]})});};export default SearchResults;","map":{"version":3,"names":["React","useEffect","useState","useParams","useDispatch","useSelector","setSearchResults","toggleUpvote","toggleDownvote","loadSearchPosts","notify","PostCard","LoadMoreButton","LoadingSpinner","getErrorMsg","Container","Paper","Typography","useSearchPageStyles","SearchIcon","SentimentVeryDissatisfiedIcon","jsx","_jsx","jsxs","_jsxs","SearchResults","classes","_useParams","query","dispatch","searchResults","state","search","_useState","_useState2","_slicedToArray","page","setPage","_useState3","_useState4","loadingMore","setLoadingMore","_useState5","_useState6","pageLoading","setPageLoading","getSearchResults","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","t0","stop","apply","arguments","disableGutters","children","variant","className","mainPaper","text","handleLoadPosts","_ref2","_callee2","_callee2$","_context2","prevState","color","infoPaper","fontSize","style","marginRight","results","length","map","s","post","id","noResults","sorryIcon","loading"],"sources":["C:/Ak/E/reddish-master/client/src/components/SearchResults.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {\n  setSearchResults,\n  toggleUpvote,\n  toggleDownvote,\n  loadSearchPosts,\n} from '../reducers/searchReducer';\nimport { notify } from '../reducers/notificationReducer';\nimport PostCard from './PostCard';\nimport LoadMoreButton from './LoadMoreButton';\nimport LoadingSpinner from './LoadingSpinner';\nimport getErrorMsg from '../utils/getErrorMsg';\n\nimport { Container, Paper, Typography } from '@material-ui/core';\nimport { useSearchPageStyles } from '../styles/muiStyles';\nimport SearchIcon from '@material-ui/icons/Search';\nimport SentimentVeryDissatisfiedIcon from '@material-ui/icons/SentimentVeryDissatisfied';\n\nconst SearchResults = () => {\n  const classes = useSearchPageStyles();\n  const { query } = useParams();\n  const dispatch = useDispatch();\n  const searchResults = useSelector((state) => state.search);\n  const [page, setPage] = useState(1);\n  const [loadingMore, setLoadingMore] = useState(false);\n  const [pageLoading, setPageLoading] = useState(true);\n\n  useEffect(() => {\n    const getSearchResults = async () => {\n      try {\n        setPageLoading(true);\n        await dispatch(setSearchResults(query));\n        setPageLoading(false);\n      } catch (err) {\n        dispatch(notify(getErrorMsg(err), 'error'));\n      }\n    };\n    getSearchResults();\n    setPage(1);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [query]);\n\n  if (!searchResults || pageLoading) {\n    return (\n      <Container disableGutters>\n        <Paper variant=\"outlined\" className={classes.mainPaper}>\n          <LoadingSpinner text={'Searching for matches...'} />\n        </Paper>\n      </Container>\n    );\n  }\n\n  const handleLoadPosts = async () => {\n    try {\n      setLoadingMore(true);\n      await dispatch(loadSearchPosts(query, page + 1));\n      setPage((prevState) => prevState + 1);\n      setLoadingMore(false);\n    } catch (err) {\n      dispatch(notify(getErrorMsg(err), 'error'));\n    }\n  };\n\n  return (\n    <Container disableGutters>\n      <Paper variant=\"outlined\" className={classes.mainPaper}>\n        <Paper variant=\"outlined\">\n          <Typography\n            variant=\"h6\"\n            color=\"secondary\"\n            className={classes.infoPaper}\n          >\n            <SearchIcon fontSize=\"large\" style={{ marginRight: '7px' }} />\n            Showing search results for \"{query}\"\n          </Typography>\n        </Paper>\n        {searchResults.results.length !== 0 ? (\n          searchResults.results.map((s) => (\n            <PostCard\n              key={s.id}\n              post={s}\n              toggleUpvote={toggleUpvote}\n              toggleDownvote={toggleDownvote}\n            />\n          ))\n        ) : (\n          <Typography variant=\"h5\" className={classes.noResults}>\n            <SentimentVeryDissatisfiedIcon\n              className={classes.sorryIcon}\n              color=\"primary\"\n            />\n            Sorry, there were no post results for \"{query}\"\n          </Typography>\n        )}\n        {'next' in searchResults && (\n          <LoadMoreButton\n            handleLoadPosts={handleLoadPosts}\n            loading={loadingMore}\n          />\n        )}\n      </Paper>\n    </Container>\n  );\n};\n\nexport default SearchResults;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}